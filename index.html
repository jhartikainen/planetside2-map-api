<!DOCTYPE html>
<html>
	<head>
		<script src="lib/leaflet-0.5-src.js"></script>
		<script src="src/sectors.js"></script>
		<script src="src/sectors-amerish.js"></script>
		<script src="src/sectors-esamir.js"></script>
		<script src="src/Map.js"></script>
		<script src="src/map/TileLayer.js"></script>
		<script src="src/map/SectorLayer.js"></script>
		<script src="src/map/SectorInfoLayer.js"></script>
		<script src="src/map/ContinentControl.js"></script>
		<script src="src/map/LayerControl.js"></script>
		<script src="src/map/GridLayer.js"></script>
		<script src="src/data/SectorControl.js"></script>
		<script src="src/data/sector-id-map.js"></script>
		<link rel="stylesheet" href="lib/leaflet.css" type="text/css">
		<link rel="stylesheet" href="src/map-styles.css" type="text/css">
	</head>

	<body>
		<div id="map" style="height: 600px"></div>
		<script>
			map = new ps2hq.Map('map');
			map.on('sector-over', function(ev) {
				console.dir(ev);
				//ev.target.setStyle({ fillColor: 'white' });
			});
			map.on('sector-click', function(ev) {
				console.dir(ev);
			});
			map.on('sector-out', function(ev) {
				//ev.target.setStyle({ fillColor: 'red' });
				console.dir(ev);
			});

			map.on('change-continent', function(ev) {
				sec.load(10, ev.continent, colorHexes);
			});

			var factionColors = { TR: 'red', NC: 'blue', VS: 'purple' };
			var colorHexes = function(data) {
				for(var name in data) {
					var faction = data[name];
					var sector = map.getSectorByName(name);
					if(sector) {
						sector.poly.setStyle({ fillColor: factionColors[faction] });
					}
					else {
						console.log('Missing: ' + name);
					}
				}
			};
			sec = new ps2hq.data.SectorControl({ serviceId: 'ps2hq-test' });
			sec.load(10, 'indar', colorHexes);

		</script>
	</body>
</html>
